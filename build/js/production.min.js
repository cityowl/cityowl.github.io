function ModalAbstract(e){this.isModalOpened=ko.observable(!0),this.options=e}function AddIssueView(e){var t=this;this.id="add-issue",this.title="Add issue",this.issue_name=ko.observable("").extend({required:"Please enter a Name"}),this.issue_desc=ko.observable("").extend({required:"Please enter a Description"}),this.buttons=Array.prototype.concat([{btnName:"Add",btnClass:"button-primary",onClick:function(){t.issue_name.fa(),t.issue_desc.fa(),t.issue_name.hasError()||t.issue_desc.hasError()||(t.options.onAdd({name:t.issue_name(),desc:t.issue_desc()}),t.close())}}],this._getDefaultButton()),ModalAbstract.call(this,e)}var Model={STATE_WAITING:"Waiting",STATE_IN_PROCESS:"InProcess",STATE_DONE:"Done"};Model.getCollection=function(){return[{name:Model.STATE_WAITING,accepts:["Done","InProcess"],collection:ko.observableArray(Storage.getJson(Model.STATE_WAITING))},{name:Model.STATE_IN_PROCESS,accepts:["Waiting","Done"],collection:ko.observableArray(Storage.getJson(Model.STATE_IN_PROCESS))},{name:Model.STATE_DONE,accepts:["Waiting","InProcess"],collection:ko.observableArray(Storage.getJson(Model.STATE_DONE))}]},Model.get=function(e){for(var t=Storage.getJson("issues"),s=[],o=0;o<t.length;o++)t[o].type===e&&s.push(t[o]);return s};var Storage={get:function(e){return localStorage.getItem(e)},set:function(e,t){localStorage.setItem(e,t)},setJson:function(e,t){t=JSON.stringify(t),this.set(e,t)},getJson:function(e){return this.isset(e)?JSON.parse(this.get(e)):void 0},isset:function(e){return Object.prototype.hasOwnProperty.call(localStorage,e)},unset:function(e){this.isset(e)&&localStorage.removeItem(e)}};ko.extenders.required=function(e,t){function s(s){e.hasError(!s),e.validationMessage(s?"":t||"This field is required")}return e.hasError=ko.observable(),e.validationMessage=ko.observable(),e.subscribe(s),e},function(e){function t(){var t=this;this.states=e.getCollection(),this.modals=ko.observableArray([]);for(var s=0;s<this.states.length;s++){this.states[s].name;this.states[s].drop=function(e,s){var o=this.element.attributes["data-target"].nodeValue,n=t._getStateIndex(o),a=t._getStateIndex(e.type);t.states[a].collection.remove(e),Storage.setJson(e.type,t.states[a].collection()),e.type=o,t.states[n].collection.push(e),Storage.setJson(o,t.states[n].collection())},this.states[s].remove=function(e){var s=t._getStateIndex(e.type);t.states[s].collection.remove(e),Storage.setJson(e.type,t.states[s].collection())}}this.addIssue=function(){var t=this,s=t._getStateIndex(e.STATE_WAITING);this.modals.push(new AddIssueView({onAdd:function(o){var n={type:e.STATE_WAITING,title:o.name,desc:o.desc};t.states[s].collection.push(n),Storage.setJson(e.STATE_WAITING,t.states[s].collection()),t.modals([])}}))},this._getStateIndex=function(e){for(var t=0;t<this.states.length;t++)if(this.states[t].name===e)return t}}ko.applyBindings(new t)}(Model),ModalAbstract.prototype.close=function(){this.isModalOpened(!1)},ModalAbstract.prototype._getDefaultButton=function(){var e=this;return[{btnName:"Close",btnClass:"",onClick:function(){e.close()}}]},AddIssueView.prototype=Object.create(ModalAbstract.prototype);